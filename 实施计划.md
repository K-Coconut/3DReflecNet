# 3DReflectNet 静态网站实施计划

## 项目概述

构建一个用于展示 3D 渲染数据库的静态网站，支持在 GitHub Pages 上部署。

## 技术栈

- **前端框架**: React 18
- **UI 组件库**: Ant Design 5
- **构建工具**: Vite
- **部署平台**: GitHub Pages
- **开发语言**: TypeScript

## 数据结构

### 实例数据结构
每个实例文件夹包含：

- `depth/` - 深度图 (PNG 格式)
- `mask/` - 遮罩图 (PNG 格式)
- `normal/` - 法线图 (PNG 格式)
- `train/` - RGB 训练图片 (PNG 格式)
- `meta.json` - 元数据（类别、模型、材质、环境贴图等）
- `transforms_train.json` - 相机参数

### 类别映射
实例类别对应的文件夹：
- `3D_models` → household (家居)
- `Roman_Statue` → art (艺术)
- `beds`, `cabinets`, `chairs`, `lamps`, `shelves`, `sofas`, `tables`, `tablesets` → household (家居)
- `crystal` → art (艺术)
- `electronic` → industry (工业)
- `plants` → nature (自然)

注：

- 实例展示跳过 EXR 格式文件，仅展示 PNG 格式图片
- 环境贴图（HDRI）为 EXR 格式，需要特殊处理才能在网页中展示
- 项目支持动态扩展，可随时添加新的实例文件夹

## 功能模块

### 1. 数据索引生成

- 扫描所有实例文件夹和环境贴图文件夹（支持增量扫描）
- 提取每个实例的元数据
- 生成实例索引 JSON 和环境贴图索引 JSON
- 包含图片路径、类别、材质等信息
- 构建脚本可重复执行，自动发现新增内容

### 2. 主页面 - 导航页

- 展示项目介绍和概览
- 提供两个主要入口：
  - Instance Gallery (实例展示)
  - Environment Maps (环境贴图展示)
- 显示数据库统计信息（实例数量、环境贴图数量等）
- 响应式设计，支持移动端

### 3. 实例展示模块

#### 3.1 实例图库视图

- 网格布局展示所有实例
- 每个实例显示预览图（默认第一帧）
- 显示实例名称和基本信息
- 支持无限滚动或分页

#### 3.2 实例过滤面板

- **类别过滤**:
  - household (家居)
  - industry (工业)
  - art (艺术)
  - nature (自然)
- **图片类型过滤**:
  - RGB (train/)
  - Depth (depth/)
  - Normal (normal/)
  - Mask (mask/)
- 支持多选和组合过滤

#### 3.3 实例详情页

- 展示单个实例的所有渲染帧
- 图片类型切换标签
- 帧序列浏览器
- 元数据信息展示
- 图片放大查看功能

### 4. 环境贴图展示模块

#### 4.1 环境贴图图库

- 网格布局展示所有环境贴图（EXR格式）
- 缩略图预览（需要将EXR转换为可展示格式）
- 显示环境贴图名称

#### 4.2 环境贴图过滤（待定）

- 暂无分类，过滤功能待后续开发
- 搜索功能

#### 4.3 环境贴图详情

- 大图查看
- 相关实例展示（使用该环境贴图的实例）
- 技术参数展示

### 5. LiDAR扫描图像展示模块

#### 5.1 LiDAR图像图库
- 网格布局展示所有LiDAR扫描图像
- 每个LiDAR扫描集显示预览图（默认第一帧）
- 显示扫描集名称和帧数信息
- 支持分页或无限滚动

#### 5.2 LiDAR图像详情页
- 展示单个扫描集的所有帧
- 帧序列浏览器（滑块控制）
- 图片放大查看功能
- 帧信息展示（帧号、时间戳等）

### 6. 性能优化

- 图片懒加载
- 缩略图生成
- 路由懒加载
- 资源预加载

## 项目结构

```
3DReflectNet/
├── web/                              # 前端项目目录
│   ├── src/
│   │   ├── components/
│   │   │   ├── common/
│   │   │   │   ├── Gallery/          # 通用图库组件
│   │   │   │   │   ├── index.tsx
│   │   │   │   │   ├── LazyImage.tsx
│   │   │   │   │   └── Gallery.css
│   │   │   │   ├── FilterPanel/      # 通用过滤面板
│   │   │   │   │   ├── index.tsx
│   │   │   │   │   └── FilterPanel.css
│   │   │   │   └── ImageViewer/      # 图片查看器
│   │   │   │       ├── index.tsx
│   │   │   │       └── ImageViewer.css
│   │   │   ├── instances/
│   │   │   │   ├── InstanceGallery/  # 实例图库
│   │   │   │   ├── InstanceFilter/   # 实例过滤
│   │   │   │   └── InstanceDetail/   # 实例详情
│   │   │   │       ├── index.tsx
│   │   │   │       └── InstanceDetail.css
│   │   │   ├── environments/
│   │   │   │   ├── EnvMapGallery/    # 环境贴图图库
│   │   │   │   └── EnvMapDetail/     # 环境贴图详情
│   │   │   └── lidars/
│   │   │       ├── LidarGallery/     # LiDAR图像图库
│   │   │       └── LidarDetail/      # LiDAR图像详情
│   │   ├── pages/
│   │   │   ├── Home.tsx              # 主页（导航页）
│   │   │   ├── Instances.tsx         # 实例展示页
│   │   │   ├── InstanceDetail.tsx    # 实例详情页
│   │   │   ├── Environments.tsx      # 环境贴图展示页
│   │   │   ├── EnvMapDetail.tsx      # 环境贴图详情页
│   │   │   ├── Lidars.tsx            # LiDAR图像展示页
│   │   │   └── LidarDetail.tsx       # LiDAR图像详情页
│   │   ├── hooks/
│   │   │   ├── useInstancesData.ts   # 实例数据获取钩子
│   │   │   ├── useEnvironmentsData.ts # 环境贴图数据获取钩子
│   │   │   └── useLidarsData.ts      # LiDAR数据获取钩子
│   │   ├── utils/
│   │   │   ├── filterInstances.ts    # 实例过滤工具
│   │   │   └── getAssetPath.ts       # 资源路径处理
│   │   ├── types/
│   │   │   └── index.ts              # TypeScript类型定义
│   │   ├── data/
│   │   │   ├── instances.json        # 实例索引
│   │   │   ├── environments.json     # 环境贴图索引
│   │   │   └── lidars.json           # LiDAR图像索引
│   │   ├── App.tsx
│   │   ├── App.css
│   │   ├── main.tsx
│   │   └── index.css
│   ├── scripts/
│   │   ├── buildInstanceData.js      # 构建实例数据索引脚本
│   │   ├── buildEnvMapData.js        # 构建环境贴图索引脚本
│   │   └── buildLidarData.js         # 构建LiDAR数据索引脚本
│   ├── public/
│   │   ├── instances/                # 实例数据文件夹（符号链接）
│   │   ├── environments/             # 环境贴图文件夹（符号链接）
│   │   ├── lidars/                   # LiDAR数据文件夹（符号链接）
│   │   ├── instances.json            # 实例数据索引
│   │   ├── environments.json         # 环境贴图数据索引
│   │   └── lidars.json               # LiDAR数据索引
│   └── package.json
├── instances/                        # 实例原始数据
│   ├── 3D_models/                    # 模型类别
│   │   └── 1_kloppenheim_02_enamel/
│   │       ├── depth/                # 深度图
│   │       ├── mask/                 # 遮罩图
│   │       ├── normal/               # 法线图
│   │       ├── train/                # RGB训练图
│   │       ├── meta.json             # 元数据
│   │       └── transforms_train.json # 相机参数
│   ├── Roman_Statue/                 # 雕像类别
│   ├── beds/                         # 床类别
│   ├── cabinets/                     # 柜子类别
│   ├── chairs/                       # 椅子类别
│   ├── crystal/                      # 水晶类别
│   ├── electronic/                   # 电子产品类别
│   ├── lamps/                        # 灯具类别
│   ├── plants/                       # 植物类别
│   ├── shelves/                      # 货架类别
│   ├── sofas/                        # 沙发类别
│   ├── tables/                       # 桌子类别
│   └── tablesets/                    # 餐具类别
├── environments/                     # 环境贴图原始数据
│   ├── abandoned_garage_4k.exr
│   ├── autumn_field_puresky_4k.exr
│   └── ... (其他HDRI文件)
└── lidars/                           # LiDAR扫描原始数据
    ├── gold_lion/                    # 扫描集
    │   ├── frame_00001.png
    │   ├── frame_00002.png
    │   └── ... (其他帧图片)
    └── ... (其他扫描集)
```

## 开发步骤

### 第一阶段：项目初始化 ✅

1. ✅ 创建 Vite + React + TypeScript 项目
2. ✅ 配置 Ant Design
3. ✅ 设置基础路由（主页、实例模块、环境贴图模块）
4. ✅ 配置 GitHub Pages 部署（基础配置已完成）

### 第二阶段：数据处理

1. 编写实例数据扫描脚本
2. 编写环境贴图扫描脚本
3. 编写LiDAR数据扫描脚本
4. 生成实例索引 JSON、环境贴图索引 JSON 和 LiDAR索引 JSON
5. 处理图片路径映射

### 第三阶段：主页开发

1. 设计主页布局
2. 实现导航入口
3. 添加数据统计展示
4. 响应式设计适配

### 第四阶段：实例模块开发

1. 实现实例图库网格布局
2. 开发实例过滤面板
3. 创建实例详情页
4. 实现图片查看器

### 第五阶段：环境贴图模块开发

1. 实现环境贴图图库
2. 处理EXR文件预览（转换为PNG或使用tone mapping）
3. 创建环境贴图详情页
4. 实现关联实例展示

### 第六阶段：LiDAR模块开发

1. 实现LiDAR图像图库
2. 创建LiDAR详情页（帧序列浏览）
3. 实现帧控制滑块
4. 添加图片查看器

### 第七阶段：优化与部署

1. 添加懒加载
2. 优化构建配置
3. 设置 GitHub Actions
4. 部署到 GitHub Pages

## 部署配置

### GitHub Actions Workflow

```yaml
name: Deploy to GitHub Pages
on:
  push:
    branches: [main]
jobs:
  deploy:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - uses: actions/setup-node@v3
      - run: npm install
      - run: npm run build
      - uses: peaceiris/actions-gh-pages@v3
```

### Vite 配置

- 设置正确的 base URL
- 优化 chunk 分割
- 启用 gzip 压缩

## 时间估算

- 项目搭建：2 小时
- 数据处理脚本：5 小时（实例+环境贴图+LiDAR）
- 主页开发：3 小时
- 实例模块开发：6 小时
- 环境贴图模块开发：5 小时
- LiDAR模块开发：4 小时
- 优化与测试：3 小时
- 部署配置：2 小时

总计：约 30 小时

## 注意事项

1. 图片文件较多，需要考虑加载性能
2. GitHub Pages 有仓库大小限制（1GB）
3. 静态站点无法使用服务端功能
4. 需要处理路由刷新 404 问题
5. 数据更新流程：添加新实例文件夹后，需重新运行构建脚本并部署
6. 类别限定为：household、industry、art、nature 四种
